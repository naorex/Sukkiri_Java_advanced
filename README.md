# スッキリわかるJava入門 実践編 第4版

## Chapter1 インスタンスの基本操作

### Objectの3つの基本操作（新たにクラスを定義する際にやる事）

- `toString()` をオーバーライドして文字列表現を定義できる。
- `equals()` をオーバーライドして意味的に正しく等価を判定できるようにする。
- `hashCode()` を正しくオーバーライドしておくことで、ハッシュ値を用いるクラス（`HashMap`など）を利用できるようになる。

### 順序付け

- `Comparable` インタフェースを実装することで自然順序付けを定義でき、容易に並び替えできるようになる。
- `Comparator` インタフェースを実装し、自然順序以外の並び順を定義できる。

### 複製

- `Cloneable` インタフェースを実装した上で `clone()` をオーバーライドすることで、インスタンスを容易に複製できるようになる。
- インスタンスの複製方法には、インスタンスの参照先を考慮した深いコピーと、考慮しない浅いコピーがある。
- インスタンスを完全に複製するには、深いコピーが必要である。

### レコード

- `record` を用いると、フィールドとコンストラクタ・アクセサに加え、重要な `toString()`・`hashCode()`・`equals()` の3つのメソッドを適切にオーバーライドしたクラスを手軽に定義できる。
- `record` は継承を利用できないが、特にデータキャリアなどの実装用途には差し支えないことも多い。

## Chapter2 様々な種類のクラス

### 型安全

- 取り扱う変数に対して型による制約を与えることで、処理の安全性を向上させる考え方を、型安全という。

### ジェネリクス

- `< >` 記法を用いて、ジェネリクスを定義できる。
- ジェネリクスを用いたクラスやメソッドは、利用時に型を決定する。
- ジェネリクスによって汎用的なクラスやメソッドが提供できるとともに、利用時には型安全性を確保できる。

### 列挙型とシールクラス

- `enum` を用いて、インスタンスを列挙した集合を定義できる。
- シールクラスで継承先クラスを限定し、クラスを列挙した集合を定義できる。
- 列挙型やシールクラスは、`switch` 文の分岐に利用できる。

### インナークラス

- クラスの内部に定義できるインナークラスには、「メンバクラス」「ローカルクラス」「匿名クラス」の3種類がある。
- 匿名クラスは、その場限りのクラスを定義して使い捨てたい場面で活用する。

### null安全性

- `Optional` クラスをメソッドの戻り値の型として用いると、null安全性に配慮したプログラムを作成できる。
- 専用に準備されたクラスを用いて基本データ型にも適用できる。

## Chapter3 関数とラムダ式

### 関数オブジェクト

- Java では関数を第1級オブジェクトとして扱う。
- 関数とは「入力・処理・出力 (IPO) を有する処理ロジック」である。
- クラス内に定義されたメソッドへの参照を、関数オブジェクトとして変数に代入できる。
- 1つの抽象メソッドのみを持つインターフェースは、関数インターフェースとして、関数を格納することができる。
- `java.util.function` パッケージには、代表的な関数インターフェースがあらかじめ準備されている。
- 引数として関数を受け取る関数を高階関数という。

### ラムダ式

- ラムダ式を用いることで、関数の実体をプログラム実行中に生成できる。
- ラムダ式にはさまざまな省略記法が用意されており、簡単な関数であればシンプルに記述することができる。
- ラムダ式は、自身が生成されたときに利用可能であった変数をラムダ式内部で利用できる。ただし、実質的に final な変数の読み取りに限られる。

### Stream API

- 1次元のデータ集合に対する処理は、高階関数を用いて宣言的に書き直せる。
- コレクションや配列から生成したストリームに対してメソッドを呼ぶことで、宣言的なデータ処理を実現できる。
- ストリームの中間処理メソッドは連鎖的に呼び出すことができる。

## Chapter4 JVM 制御とリフレクション

### JVMに対する制御

- `System.exit()` はプログラムを終了させ、OSに終了コードを返す。
- `ProcessBuilder` クラスを利用して、外部プログラムを起動できる。
- `System.getProperty()` や `System.setProperty()` を利用して、システムプロパティの取得や設定ができる。
- ロケール、タイムゾーンに関する情報は、それぞれ、`java.util.Locale` クラス、`java.util.TimeZone` クラスを用いて管理することができる。
- `Runtime` クラスの `freeMemory()`、`totalMemory()`、`maxMemory()` を用いて、JVMのメモリの状況を取得できる。

### リフレクション

- `Class` クラスを用いて、型に関するさまざまな情報を取得できる。
- メンバに関する情報は、`Field`、`Method`、`Constructor` の各クラスのインスタンスとして取得できる。
- リフレクションAPIを用いて、クラスやメンバに対してどのような修飾 (public や final など) がされているかを調べることができる。
- リフレクションAPIを用いて、フィールドの値の読み書きやメソッドの実行を行うこともできる。
- リフレクションAPIを用いると、アクセス制御を回避してメンバを利用することができるが、むやみに使うべきものではない。

## Chapter5 非標準ライブラリの活用

### ライブラリとクラスパス

- 第三者が作成したクラスファイルを集めたものをライブラリという。
- ライブラリは通常 JAR ファイルの形式で提供される。
- ライブラリを利用するには、JAR ファイルをクラスパスに含める必要がある。

### 代表的なライブラリ

- Apache プロジェクトでは多数の優良なライブラリが公開されている。
- commons-lang は Java 言語の基本機能を強化するさまざまなクラスを備えている。
- Log4j 2 などのロガーライブラリを用いて、ログを画面やファイルに出力することができる。
- SLF4J のように「ほかのライブラリを利用するためのライブラリ」も存在する。

### オープンソースとライセンス

- オープンソース製品はソースコードが公開されており、自由に再頒布できる。
- オープンソースは基本的に非保証で現状のまま提供される。
- 故意か否かに関わらず、ライセンス違反を行うと重大なペナルティを科せられることがある。
- ライセンスとして問題のない利用かどうかは、安易に自分だけで判断しない。
- 特段の注意を要する代表的な OSS ライセンスとして、GPL と LGPL がある。

## Chapter6 ファイルの操作


### ストリームの概念

- JVM がデータをやりとりする伝送路を表すストリームという概念がある。
- 文字が流れる文字ストリーム、バイトが流れるバイトストリームがある。
- ファイルのほか、ネットワークやキーボードなどもストリームを用いてデータ をやりとりできる。

### ファイルの基本的な操作

- ファイルを前から順に読み書きする方法をシーケンシャルアクセスという。
- ファイルの読み書きには、次のようなクラスを利用する。

| | 読み取り | 書き込み |
| :--- | :--- | :--- |
| テキストファイル | `FileReader` | `FileWriter` |
| バイナリファイル | `FileInputStream` | `FileOutputStream` |

- ファイルは必ず `finally` ブロックまたは `try-with-resources` 文を利用して閉じな ければならない。

### フィルタ

- フィルタはほかのストリームやフィルタに連結して利用できる。
- Java の API では多様なフィルタが提供されている。
- ファイルの読み書きには通常バッファリングフィルタを併用する。

### ファイルシステムの操作

- `java.io.File` を用いて、特定のファイルやフォルダを指し示すことができる。
- `java.io.File` では、ファイルの削除や情報取得などの簡単な操作も行える。
- `java.nio.Path` と `java.nio.Files` を用いて、より高度な操作を簡単に行える。

## Chapter7 様々なファイル形式

### CSV形式

- データをカンマで区切って格納する形式を CSV 形式という。
- さまざまな種類の CSV に対応するため、ライブラリを用いることが多い。

### プロパティファイル形式

- Properties クラスを用いて、キーと値のペアで読み書きできる。
- ResourceBundle クラスを用いて、クラスパスからファイルを検索し、ロケールに対応した値を取り出して利用できる。

### XML 形式と JSON 形式

- XML ではタグを用いた記述により、ネストしたデータ構造を表現できる。
- JSON は、XML より手軽な構文で、ネストしたデータ構造を表現できる。
- XML や JSON は、各種のライブラリを用いて読み書きできる。

### 直列化機構

- 直列化のしくみを使うと、インスタンスを丸ごとバイト列と相互変換できる。
- 直列化に対応するためには java.io.Serializable インタフェースを実装する。
- 直列化が可能なクラス型のフィールドも連鎖的に直列化される。
- クラス設計の変化に備えるために、シリアルバージョンUID の宣言を行う。

### その他の形式

- 標準API やライブラリを用いて、Microsoft Office・アーカイブ・音声・画像など、さまざまな形式のファイルを Java から読み書きできる。

## Chapter8 ネットワークアクセス

### URLクラスを用いた高水準アクセス

- URLクラスを用いることで手軽に Web ページを取得できる。
- openStream メソッドによって、サーバ側の Web ページの内容を取り出すストリームを取得できる。

### Socket クラスを用いた低水準アクセス

- Socket クラスを使って TCP/IP 接続を行うことができる。
- 接続に際しては、IPアドレスまたはホスト名とポート番号を指定する。
- 接続後のデータ書式や通信手順は、上位プロトコルで定められている。
- ServerSocket クラスを使うと、指定したポート番号で接続を待ち受けるサーバプログラムを作成できる。

### Web と HTTP

- インターネット上のWebサーバにアクセスしてページを取得し、リンクでほかのページを巡るしくみをWebという。
- Web では、HTTP というプロトコルが利用され、1往復のリクエストとレスポンスで完結する。
- リクエストやレスポンスの内部構造の詳細は RFC で定められている。

### HttpClient クラスを用いた高水準アクセス

- 別のシステムから HTTP で接続を受け付け、連携して動作する WebAPI が普及している。
- HttpClient クラスを用いると、メソッド・パラメータ・本文などを細かく指定して HTTP通信を行う。
- 代表的な WebAPI の設計哲学として、REST がある。

## Chapter9 DB アクセス

### データベースと SQL

- データベースは検索性能、並列実行、トランザクション制御など、ファイルにはない特長を持つ。
- リレーショナルデータベース (RDB) は、データを表形式で管理する。
- RDB は SQLという専用の言語で書かれた命令を使って操作する。
- SQLを用いて検索 (SELECT)、挿入 (INSERT)、更新 (UPDATE)、削除 (DELETE) の4つの基本的な操作を行うことができる。

### JDBCによるデータベースの操作

- データベースに SQL文を送信するには JDBC という API を利用する。
- 利用する DBMS のドライバ (JARファイル) にクラスパスを通しておく。
- DriverManager と Connection でデータベースに接続し、切断する。
- PreparedStatement を使って SQL文を組み立て、送信する。
- ResultSet を使ってデータベースから返された結果表のデータを取得する。
- データベースを利用したプログラムでは、パターンを活用できることが多い。

### データ型

- java.util.Date 型の情報は、TIMESTAMP型の列に格納する。
- java.sql.Timestamp を使ってパラメータに日時情報を指定する。
- ResultSetのgetTimestamp() を使って、結果表から日時情報を取り出す。
- java.util.Dateとjava.sql.Date はまったく別のクラスと捉える。

## Chapter 10 基本的な開発ツール

### 開発効率とツールの活用

- 本格的、実践的な開発では、開発効率を意識することも重要となる。
- JDK に標準添付されているさまざまなツールを上手に使って、最低限の開発効率を確保する。

### さまざまな開発ツール

- `Javadoc` は、javadoc タグや javadoc コメントを解釈してプログラム仕様書を自動的に生成する。
- `javac` コマンドは、アノテーションを解釈しながらコンパイルを行う。
- `jar` コマンドは、クラスファイルやプロパティファイルを1つのアーカイブファイルにまとめることができる。
- `java` コマンドは、JVM を起動しバイトコードをマシン語に変換しながらプログラムを実行する。
- ヒープ不足を防ぐため、JVM 内ではガーベジコレクション（GC）と呼ばれるしくみが動作し、不要なインスタンスを解放する。
- GC の動作中は処理性能が著しく低下するうえ、その発生タイミングを制御することは基本的にできない。

### ビルドの自動化

- Ant や Maven を利用することによって、効率的にビルド工程を自動化できる。
- Maven では、`pom.xml` に必要な情報を記述し、標準フォルダ構成に従ってファイルを配置したうえで独自のコマンドを実行する。
- `pom.xml` に依存情報を明示すれば、必要なライブラリのダウンロードをMavenが自動的に行ってくれる。

## Chapter 11 単体テストとアサーション
